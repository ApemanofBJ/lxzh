<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>网络环境搭建实战</title>
	<link rel="stylesheet" href="../../CSS/global.css">
</head>

<body>
	<img src="../../pic/it/os/企业IT架构.png" alt="">
	<p>大企业网络核心层一般采用冗余节点和冗余线路的拓扑结构，小企业则单线路的连接方式</p>
	<ul>网络需求-网络结点数量
		<li>首先是资源共享，网络内的各个桌面用户可共享文件服务器/数据库、共享打印机，实现办公自动化系统中的各项功能；(内网功能)</li>
		<li>其次是通信服务，最终用户通过广域网连接可以收发电子邮件、实现Web应用、接入互联网、进行安全的广域网访问；(外网通信)</li>
		<li>还有就是公司门户网站和网络通信系统（企业邮箱、企业即时通信和企业短信平台等）的建立(外网平台)</li>
	</ul>
	<img src="../../pic/it/os/网络架构图.png" alt="">

	<h2>第一部分 网络设备</h2>
	<p>交换机及路由器都是包交换机，包括入链路和出链路</p>

	<h3>&sect; &sect;1.1 router 路由器</h3>
	<p><a href="http://www.net130.com/tutorial/ciscojc/">
	cisco路由器配置手册-ciscostation</a></p>

	<h4>&sect;1.1.1 路由协议：</h4>
	<p>路由分为静态路由和动态路由，其相应的路由表称为静态路由表(由管理员手工修改和维护，CPU利用率低、包转发率高)和动态路由表(动态变化-由路由协议自动计算数据传输的最佳路径)。<br>
		虚电路网络<br>
		数据包网络<br>
	</p>

	<ul type="circle">
		<li>RIP协议 ：<br>
		底层是贝尔曼福特算法，它选择路由的度量标准（metric)是跳数，最大跳数是15跳，如果大于15跳，它就会丢弃数据包</li>
		<li>OSPF协议：<br>
		Open Shortest Path First开放式最短路径优先，底层是迪杰斯特拉算法，是链路状态路由选择协议，它选择路由的度量标准是带宽，延迟</li>
		<li>MTU最大传输单元--Maximum Transmission Unit</li>
	</ul>

	<h4>&sect;1.1.2 命令行</h4>
	<p>
	命令行 用户模式/特权模式/配置模式<br>
	Enable/disable<br>
	Interface gigabitEthernet 0/1<br>
	Ip address 192.168.1.254 255.255.255.0#接口地址<br>
	No shutdown #激活接口<br>
	Write #保存<br>
	</p>

	<h4>&sect;1.1.3 实际问题</h4>

	<p>多WAN口路由器设置<br>
	分别设置两个wan口连接方式（动态、静态还是pppoe拨号）<br>
	设置每个wan口的上下行带宽（必须设置，否则可能无法启动负载均衡功能）<br>
	在传输控制中开启路由器的带宽“智能均衡”功能</p>

	<p>多外网访问的自由切换<br>
	A路由的LAN口改为不和公司一个段，然后关闭A的DHCP<br>
	A路由内接的那个子部门的所有电脑都手工设置和A路由地址段相同的固定IP地址，网关都设为A路由LAN口的IP地址。DNS就为A路由获取的那个宽带服务商的DNS即可<br>
	继续添加一个IP地址为B网络内的IP地址，不设B网络的网关。去命令行内操作route命令绑定针对B路由的网关的路由指向<br>
	重点：Windows的本地连接那是支持多IP地址设置</p>

	<h4>&sect;1.1.4 扩展</h4>

	<p><b>AS</b>--autonomous system自治系统<br>
		一个自治系统将会分配一个全局的唯一的16位号码，有时我们把这个号码叫做自治系统号（ASN）<br>
		就是处于一个管理机构控制之下的路由器和网络群组.之间的链接使用外部路由协议，例如BGP<br>
	</p>

	<p id="bgp"><b>BGP</b>--Border Gateway Protocol 边界网关协议</p>
	<ul>优点
		<li>服务器只需要设置一个IP地址，最佳访问路由是由网络上的骨干路由器根据路由跳数与其它技术指标来确定的，不会占用服务器的任何系统资源。<br>
		服务器的上行路由与下行路由都能选择最优的路径，所以能真正实现高速的单IP高速访问</li>
		<li>BGP协议本身具有冗余备份、消除环路的特点，所以当IDC服务商有多条BGP互联线路时可以实现路由的相互备份，在一条线路出现故障时路由会自动切换到其它线路</li>
		<li>使网络具有很强的扩展性可以将IDC网络与其他运营商互联，轻松实现单IP多线路，做到所有互联运营商的用户访问都很快。这个是双IP双线无法比拟</li>
	</ul>

	<p id="igp"><b>IGP</b>--Interior Gateway Protocol 内部网关协议</p>

	<ul>
		<li>RIP</li>
		<li>OSPF</li>
		<li>IS-IS</li>
		<li>IGRP</li>
	</ul>	

	<p><b>InfiniBand-无线带宽</b><br>
	是一个用于高性能计算的计算机网络通信标准，它具有极高的吞吐量和极低的延迟，用于计算机与计算机之间的数据互连。</p>

	<h3>&sect; &sect;1.2 switch 交换机</h3>
	<p><a href="http://www.360doc.com/content/16/0826/21/36065737_586168944.shtml">
	cisco交换机配置手册</a></p>
	<p>
	二层交换机：通过MAC转发（可网管交换机，能够划分VLAN)<br>
	三层交换机：通过VLAN划分二层网络，实现VLAN的三层IP互访<br>
	VLAN-<br>
	Trunk 接口 级联<br>  #uplink 用于上联，trunk是干道，可上联也可下联
	Hybrid 多级接口<br>
	命令行：<br>
	Vlan 10<br>
	Interface gigabitEthernet 0/1<br>
	Switchport access Vlan 10<br>
	</p>

	<p>【旁路监控】<br>
	常见的网络监控模式可以分为两种：一种是旁路监控模式，另一种是串联监控模式。<br>
	“旁路监控模式”一般是指通过交换机等网络设备的“端口镜像”功能来实现监控，在此模式下，监控设备只需要连接到交换机的指定镜像端口，所以形象的称之为“旁路监控”。<br>

	而串联模式一般是通过网关、网桥或者代理服务器的模式来进行监控，由于监控设备做为网关或者网桥串联在网络中，所以称之为“串联监控模式”。<br>

	<ul>优点
		<li>旁路监控模式部署起来比较灵活方便，只需要在交换机上面配置镜像端口即可。不会影响现有的网络结构。而串联模式一般要作为网关、网桥或者代理服务器，所以需要对现有网络结构进行变动。</li>
		<li>旁路模式分析的是镜像端口拷贝过来的数据，对原始传递的数据包不会造成延时，不会对网速造成任何影响。而串联模式是串联在网络中的，那么所有的数据必须先经过监控系统，通过监控系统的分析检查之后，才能够发送到各个客户端，所以会对网速有一定的延时。</li>
		<li>旁路监控设备一旦故障或者停止运行，不会影响现有网络。而串联监控设备如果出现故障，会导致网络中断。</li>
	</ul>

	<ul>缺点
		<li>需要交换机或者路由支持“端口镜像”功能才可以实现监控。</li>
		<li>旁路模式采用发送RST包的方式来断开TCP连接，不能禁止UDP通讯。对于UDP应用，一般还需要在路由器上面禁止UDP端口进行配合。而串联模式不存在该问题。</li>
	</ul>

	</p>

	<table>
		<tr>
			<td rowspan="3">行业分类</td>
			<td>SMB产品</td>
			<td>华为和华3非主推的产品(行业分销产品), 型号SI</td>
		</tr>
		<tr>
			<td>企业级产品</td>
			<td>华为产品带7，其数据中心产品带8
				<ul>
					<li>LI--精简型</li>
					<li>SI--标准型</li>
					<li>EI--增强型</li>
					<li>HI--敏捷型</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>特定行业产品</td>
			<td>运营商产品带3</td>
		</tr>
	</table>

	<p>目前的网络标准是: 万兆主干,千兆到桌面</p>
	
	<h3>&sect; 1.3 VPN</h3>
	<p>Virtual Private Network--虚拟专用网络. 在公用网络上建立专用网络，进行加密通讯(属于远程访问技术)<br>
	其实质上就是利用加密技术在公网上封装出一个数据通讯隧道</p>


	<h3>&sect; 1.4 防火墙</h3>
	<p>一个安全设备, 也是一个边界设备(作为网关使用)<br>
	考虑他的两方面技术： 一个是安全策略，另一个就是做NAT</p>

	<p>接骨干网的防火墙，使用透明模式，不破坏其路由协议邻居的建立<br>
	互联网出口防火墙使用: 同时还应配合UTM网控设备，其上主要技术是安全策略、NAT、静态路由，如有需求也可以开启远程访问VPN功能，互联网防火墙使用路由模式</p>

	<p>有透明模式和路由模式两种:<br>
		透明模式不用重新进行IP划分,但是损失一些功能，如路由、VPN等；
		路由模式功能相对全面,需要对现有网络进行一定调整<br>
	</p>
	
	<h3>附录--子网划分</h3>
	<p>IP的逻辑范围, 使用工具linux-ipcalc</p>
	<img src="../../pic/it/os/ipcalc.png" alt="" width="550px" height="130px">
	
	<table>
		<tr>
			<th>计算项</th>
			<th>计算公式</th>
		</tr>
		<tr>
			<td>最多容纳主机数</td>
			<td>MAX=2^(32-位数)</td>
		</tr>
		<tr>
			<td>最多可用主机数</td>
			<td>MAX-2</td>
		</tr>
		<tr>
			<td>借用主机位-->C类网</td>
			<td>n=位数%8</td>
		</tr>
		<tr>
			<td>子网数量</td>
			<td>2^n</td>
		</tr>
		<tr>
			<td>子网掩码</td>
			<td>实际主机数的计算，即"11100000" ->结果是224</td>
		</tr>
	</table>

	<h3>&sect; 附录--网络介质</h3>
	<h4>网线</h4>
	<p>双绞线：twisted pair TP</p>
	<table>
		<tr>
			<th>分类</th>
			<th>特点</th>
		</tr>
		<tr>
			<td>5类线 CAT5 #百兆网络</td>
			<td>传输频率为100MHz，用于语音传输和最高传输速率为100Mbps的数据传输，主要用于100BASE-T和10BASE-T网络。<br>这是最常用的以太网电缆，该类电缆增加了绕线密度，外套一种高质量的绝缘材料。</td>
		</tr>
		<tr>
			<td>超5类线 CAT5e #千兆网络</td>
			<td>传输频率为100MHz，主要用于千兆位以太网（1000Mbps）。具有衰减小，串扰少，并且具有更高的衰减与串扰的比值（ACR)和信噪比（StructuralReturn Loss)、更小的时延误差，性能得到很大提高。</td>
		</tr>
		<tr>
			<td>6类线 CAT6 #千兆分槽</td>
			<td>传输频率为250MHz，最适用于传输速率高于1Gbps的应用，主要用于千兆位以太网（1000Mbps）。<br>
			六类双绞线在外形上和结构上与五类或超五类双绞线都有一定的差别，不仅增加了绝缘的十字骨架，将双绞线的四对线分别置于十字骨架的四个凹槽内，而且电缆的直径也更粗。</td>
		</tr>
	</table>

	<p>线序：1236四对<br>
		568A: 绿白-1，绿-2，橙白-3，蓝-4，蓝白-5，橙-6，棕白-7，棕-8/ 白绿绿、白橙蓝、白蓝橙、白棕棕<br>
		568B: 橙白-1，橙-2，绿白-3，蓝-4，蓝白-5，绿-6，棕白-7，棕-8/ 白橙橙、白绿蓝、白蓝绿、白棕棕<br>
		心跳线采用交叉线<br>
	</p>

	<h4>光纤</h4>
	<table>
		<tr>
			<th>分类</th>
			<th>特点</th>
		</tr>
		<tr>
			<td>光纤接头</td>
			<td>
				<ul>
					<li>FC 圆型带螺纹（配线架上用的最多)</li>
					<li>ST 卡接式圆型</li>
					<li>SC 卡接式方型（光纤收发器用的较多）</li>
					<li>LC 卡接式方形，比SC略小（光纤交换机用的较多）</li>
					<li>MT-RJ 方型，一头光纤收发一体</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>光纤模块</td>
			<td>
				<ul>
					<li>GBIC（Giga Bitrate Interface Converter）使用的光纤接口多为SC或ST型</li>
					<li>SFP小型封装GBIC，使用的光纤为LC型</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>单模和多模的标识</td>
			<td>
				<ul>
					<li>L：表示单模，波长1310纳米</li>
					<li>LH：表示单模长距，波长1310纳米，1550纳米</li>
					<li>LH：表示单模长距，波长1310纳米，1550纳米</li>
					<li>SX/LH：表示可以使用单模或多模光纤</li>
					<li>备注：单模光纤的传输距离要比多模光纤远<br>
					单模光纤一般用黄色表示，而多模光纤一般用橙色表示</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>尾纤接头的标注/</td>
			<td>
				<li>前面部分表示尾纤的连接器型号：<br>
　　“SC”接头是标准方型接头，采用工程塑料，具有耐高温，不容易氧化优点。传输设备侧光接口一般用SC接头<br>
　　“LC”接头与SC接头形状相似，较SC接头小一些。<br>
　　“FC”接头是金属接头，一般在ODF侧采用，金属接头的可插拔次数比塑料要多。
				</li>
				<li>
　　后面表明光纤接头截面工艺，即研磨方式：<br>
　　“PC” 微球面研磨抛光，在电信运营商的设备中应用得最为广泛，其接头截面是平的。<br>
　　“UPC”的衰耗比“PC”要小，一般用于有特殊需求的设备，一些国外厂家ODF架内部跳纤用的就是FC/PC，主要是为提高ODF设备自身的指标。<br>
　　“APC”呈8度角并做微球面研磨抛光，可改善电视信号的质量
				</li>
			</td>
		</tr>
	</table>

	<h3>&sect; 附录--常见网络故障</h3>
	<ul>物理层问题
		<li>线路（网线）的问题，#使用测线仪排查</li>
		<li>水晶头、光纤、光纤模块</li>
		<li>vlan 错误</li>
		<li>网络泛洪，#MAC地址更新时间较长导致的问题</li>
	</ul>

	<ul>网络层问题
		<li>网段配置错误</li>
		<li>网关配置错误</li>
		<li>掩码错误</li>
		<li>路由错误</li>
	</ul>

	<ul>应用层
		<li>DNS问题</li>
		<li>域名劫持</li>
		<li>CDN问题</li>
	</ul>

	<h3>&sect; 附录--网络管理工具</h3>

	<ul type="square">
		<li>远程连接工具：SecureCRT, 支持多种协议。 #同类软件putty、xshell</li>
		<li>文本比较工具：textdiff</li>
		<li>IP地址子网计算器</li>
		<li>批量命令生成软件，用于端口命令</li>
		<li>快速ping 工具</li>
		<li>tcping工具，某些禁ping情况下</li>
		<li>MAC地址扫描器，查看其它地址段</li>
		<li>超级网络邻居，查看共享</li>
		<li>tracert 路由跟踪，trace route图表展示</li>
		<li>ipop IP地址绑定、手工添加路由、</li>
		<li>3CDaemon, TFTP/ftp服务器</li>
		<li>HFS, 文件共享</li>
		<li>IETester, IE兼容性问题解决</li>
		<li>httpWatch 网页数据分析工具</li>
		<li>linux 模拟Cygwin</li>
		<li>LoadRunner 性能及压力测试</li>
		<li>WireShark 抓包工具</li>
		<li>科来 网络分析系统，比如限制QQ的文件传输、异常流量</li>
		<li>tcpview 免费的端口和线程监控工具</li>
		<li>SolarWinds 网络工具箱 #Watch IT</li>
		<li>PRTG Traffic Grapher 流量监控软件</li>
		<li>kiwi syslogd 日志读取工具</li>
		<li>HyperSnap 截图工具</li>
		<li>flashfxp FTP软件客户端</li>
	</ul>

	<p>PoE：简称为以太网供电,网络不仅传输数据，还可以提供直流供电。</p>
</body>
</html>
